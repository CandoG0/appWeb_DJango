{% extends "base.html" %}
{% load static %}

{% block title %}Agenda - Detalles de Tarea{% endblock title %}

{% block extra_css %}
<link href="{% static 'css/detalleTarea.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="hero-section">
    <!-- Encabezado fijo a la izquierda superior -->
    <h2 class="section-title">
        <a href="javascript:history.back()" class="back-arrow" title="Regresar">
            <i class="bi bi-arrow-left"></i>
        </a>
        Detalles de Tarea
    </h2>

    <h1>Investigación de Lenguajes de Programación Web</h1>

    <div class="contenedor-detalles">
        <!-- Información de la tarea -->
        <div class="info-tarea">
            <!-- Estado -->
            <div class="item-info">
                <div class="icono">
                    <i class="bi bi-flag"></i>
                </div>
                <div class="contenido-info">
                    <h4>Estado</h4>
                    <p class="estado-nuevo">Nuevo</p>
                </div>
            </div>

            <!-- Asignatura -->
            <div class="item-info">
                <div class="icono">
                    <i class="bi bi-book"></i>
                </div>
                <div class="contenido-info">
                    <h4>Asignatura</h4>
                    <p>Programación Web</p>
                </div>
            </div>

            <!-- Fecha de entrega -->
            <div class="item-info">
                <div class="icono">
                    <i class="bi bi-calendar-event"></i>
                </div>
                <div class="contenido-info">
                    <h4>Fecha de Entrega</h4>
                    <p>14 de Noviembre de 2024</p>
                </div>
            </div>

            <!-- Modalidad -->
            <div class="item-info">
                <div class="icono">
                    <i class="bi bi-people"></i>
                </div>
                <div class="contenido-info">
                    <h4>Modalidad</h4>
                    <p>En Equipo</p>
                </div>
            </div>

            <!-- Prioridad -->
            <div class="item-info">
                <div class="icono">
                    <i class="bi bi-exclamation-triangle"></i>
                </div>
                <div class="contenido-info">
                    <h4>Prioridad</h4>
                    <p class="estado-urgente">Alta</p>
                </div>
            </div>

            <!-- Descripción -->
            <div class="item-info descripcion-item">
                <div class="icono">
                    <i class="bi bi-card-text"></i>
                </div>
                <div class="contenido-info">
                    <h4>Descripción</h4>
                    <p>Realizar una investigación exhaustiva sobre los lenguajes de programación más utilizados en
                        desarrollo web, incluyendo análisis comparativo de JavaScript, Python, PHP y Ruby. El trabajo
                        debe incluir ejemplos prácticos, ventajas y desventajas de cada lenguaje, y casos de uso
                        recomendados para proyectos específicos.</p>
                </div>
            </div>
        </div>

        <!-- Panel de botones lateral -->
        <div class="panel-botones">
            <button type="button" class="btn-accion btn-finalizar" data-bs-toggle="modal"
                data-bs-target="#modalFinalizar">
                <i class="bi bi-check-circle"></i>Finalizar
            </button>

            <a href="#" class="btn-accion btn-editar">
                <i class="bi bi-pencil"></i>Editar
            </a>

            <button type="button" class="btn-accion btn-eliminar" data-bs-toggle="modal"
                data-bs-target="#modalEliminar">
                <i class="bi bi-trash"></i>Eliminar
            </button>
        </div>
    </div>
</div>

<!-- Modal para Finalizar Tarea -->
<div class="modal fade" id="modalFinalizar" tabindex="-1" aria-labelledby="modalFinalizarLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalFinalizarLabel">
                    <i class="bi bi-check-circle me-2"></i>Actualizar Estado de Tarea
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="estadoTarea" class="form-label">Estado Actual</label>
                    <select class="form-select" id="estadoTarea">
                        <option value="nuevo">Nuevo</option>
                        <option value="progreso">En Progreso</option>
                        <option value="finalizado">Finalizado</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="progreso" class="form-label">Progreso (%)</label>
                    <input type="range" class="form-range" id="progreso" min="0" max="100" value="0">
                    <div class="text-center">
                        <span id="valorProgreso">0%</span>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="comentarios" class="form-label">Comentarios</label>
                    <textarea class="form-control" id="comentarios" rows="3"
                        placeholder="Agrega comentarios sobre tu progreso..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-success">Guardar Cambios</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para Eliminar Tarea -->
<div class="modal fade" id="modalEliminar" tabindex="-1" aria-labelledby="modalEliminarLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalEliminarLabel">
                    <i class="bi bi-exclamation-triangle me-2"></i>Confirmar Eliminación
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>¿Estás seguro de que deseas eliminar esta tarea?</p>
                <p class="text-muted"><strong>"Investigación de Lenguajes de Programación Web"</strong></p>
                <p class="text-danger"><small>Esta acción no se puede deshacer.</small></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-danger">Eliminar Tarea</button>
            </div>
        </div>
    </div>
</div>

<script>
    // Script para mostrar el valor del rango de progreso
    document.getElementById('progreso').addEventListener('input', function () {
        document.getElementById('valorProgreso').textContent = this.value + '%';
    });

    // Script al scrollear se oculta el header
    let lastScrollY = window.scrollY;
    const sectionTitle = document.querySelector('.section-title');
    let ticking = false;

    function updateHeader() {
        if (window.scrollY > lastScrollY && window.scrollY > 100) {
            sectionTitle.classList.add('hidden');
        } else {
            sectionTitle.classList.remove('hidden');
        }
        lastScrollY = window.scrollY;
        ticking = false;
    }

    function onScroll() {
        if (!ticking) {
            requestAnimationFrame(updateHeader);
            ticking = true;
        }
    }

    window.addEventListener('scroll', onScroll, { passive: true });

    // Mostrar header al hacer hover cerca del top
    document.addEventListener('mousemove', (e) => {
        if (e.clientY < 100 && sectionTitle.classList.contains('hidden')) {
            sectionTitle.classList.remove('hidden');
        }
    });
</script>
{% endblock %}